Day5 早上的编程课讲了随机数生成器的历史以及怎么自己用Cpp写一个。然后早上理论课迎来了Peter Beerli，他是地球上最早做structured coalescent的一群人之一，他20年前写的软件Migrate-n是这个领域的标杆。他1999年的文章《Maximum-likelihood estimation of migration rates and effective population numbers in two populations using a coalescent approach》，你们猜两个作者的另外一个是谁。。是Joseph Felsenstein，对，就是Felsenstein zone那个Felsenstein。他首先介绍了为什么需要coalescent model，然后用两种动画演示了wrigth fisher model。然后是model comparison between structured and unstructured coalescent。讲了Bayes Factors为什么计算量大。然后我们做了tutorial学习了migrate-n怎么specify不同的population split和migration，然后做模型/假设检验。

Day5 下午是Scott Edwards的课，他是哈佛的鸟类进化教授，跟李恒大佬有紧密的合作。他第一部分讲了他多年在澳洲的研究，利用不同基因树，地理环境和phenotype一起研究鸟类物种分化的历史：为什么multiple species coalescent有用；alignment free的snps data竟然就可以跟地图惊人吻合；testing gene glow events。第二部分是PhyloG2P，形态学或者性状的改变本质来源于基因组的变化，历史上有哪些方法把他们联合在一起分析；有些分析很有酷，比如他结合多基因进化树，化石证据，推断不同陆地鸟类丧失飞行能力的机制，是一个convergent evolution事件，而且是受一些enhancer调控的。第三部分是pangenome。李恒最近几年在憋的pangenome项目就是跟Scott一起搞的，pangenome这个概念，是随着越来越多不同物种的基因组数据的积累，而自然形成的，你可以理解为怎么利用你可以得到的不同物种的所有基因片段的信息，然后用所有这些信息来推断物种的进化关系（复杂的点在于在进化过程中有gene duplication and loss等复杂过程，而且由于你不是关注某一个基因靶点，所以不能用reference based mapping的算法来比对基因，所以李恒要搞新的高效的算法去整合出一个pangenome graph）。Scott先讲了pangenome graph怎么得出不同物种基因组structural variations，然后这些“有害突变”和进化上面一个物种的群体数量有什么关系。

Day5晚上是龙虾晚宴，Day6是放假去跑步了。后面来更Day7。

Day6 早上的编程课讲了Cpp里面heap和stack在内存调用的不同，和object的概念，然后实践了一下。理论课迎来Joe Bielawski，他的教学风格我很喜欢，很善于引导学生思考，我最喜欢的老师之一。他在2000年前后跟Ziheng Yang一起写了很多文章，包括分子进化里面模型选择和假设检验的统计方法。Joe是蛋白质进化和突变选择模型的专家，推荐了很多实用的review和book chapters，我记在我博客的笔记里面了，之后我也要看一下。他早上主要讲群体遗传学里面分子进化中的突变与选择。包括经典的Kimura的neutral theory，和kimura学生Ohta的nearly neutral theory。Distribution of fitness effects（DFE）的概念.介绍了Mechanistic和Phenomenological Codon Models，有三种不同的情况，都可以观察到dN>dS的结果。model不同的extensions，最后讲了Phenotype-Genotype Codon Models (PhyloG2P)。

Day6 下午是Belinda Chang，多伦多大学教授，95年的哈佛博士，干湿实验结合，研究视觉蛋白的分子进化，包括不同动物感光的蛋白，还有著名的海洋动物里面的GFP荧光蛋白。她有的研究很有意思，比如她们重建了鲸鱼的祖先的视觉蛋白，发现了早期鲸鱼的视觉是更适应便蓝的颜色，在蛋白质光激发构象转变速度也更适应暗的环境。提示早期鲸鱼是可以在深水区活动的，颠覆了之前的假说。她主要的研究手法是ancestral state reconstruction然后再实验验证，让我想起了Huiling之前那篇nature microbiology（Ancestral sequence reconstruction pinpoints adaptations that enable avian influenza virus transmission in pigs）。她先是普及了一下蛋白质结构的基础知识，包括x射线晶体、核磁共振谱，和冷冻电镜这样的方法，也讨论了结构预测软件。从分子进化上，我们可以用codon model研究蛋白质的结构和功能。ancestral reconstruction的时候有很多uncertainty，需要你对模型很熟悉，比如你的tree topology，model assumptions，posterior distribution等都是要很仔细考虑的。举了哺乳动物尿酸酶研究的例子，人类在进化过程中丢失了尿酸酶的活性，导致现代人有许多代谢问题包括痛风，尿酸酶在历史上是怎么丢失的？多少个氨基酸位点？是一次性的还是逐步丢失的？这是2014年PNAS的文章。也举例了古细菌里面关键蛋白的热环境适应性的逐步变化，2008年的nature。后面来到她的熟悉的领域，视觉感光蛋白通路，夜行性动物的视觉蛋白是怎么进化的？还有谷氨酸受体和珊瑚色素的进化。



