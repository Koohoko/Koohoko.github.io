---
title: "Course notes: Infectious Disease Modelling (Imperial College London via Coursera)"
date: 2023-04-11
permalink: /posts/2023-04-11/idm-notes
categories:
  - Course notes
tags:
  - Infectious Disease Modelling
toc: true
last_modified_at: 2023-04-14
---

This post records the notes when I learnt the [Infectious Disease Modelling (IDM)](https://www.coursera.org/specializations/infectious-disease-modelling#courses) by Nimalan Arinaminpathy. 

  <img src="/files/2023-04-11-IDM/2880px-Diagram_of_SIR_epidemic_model_states_and_transition_rates.svg.png" width="500"/>


## Developing the SIR Model
### Backgrounds
#### Solving differential equations using ode() in R
  <img src="/files/2023-04-11-IDM/Screenshot%202023-04-11%20at%2016.47.16.webp" width="500"/>

- For a quick introduction to exponential and logistic equations for population growth, visit: https://www.nature.com/scitable/knowledge/library/how-populations-grow-the-exponential-and-logistic-13240157
- For more detailed references on the deSolve package, try searching for deSolve vignettes https://cran.r-project.org/web/packages/deSolve/vignettes/deSolve.pdf

#### Competing Hazards in Compartmental Models
Basically $\frac{a}{a+b+c}$:
  <img src="/files/2023-04-11-IDM/Screenshot%202023-04-11%20at%2016.51.39.webp" width="500"/>

#### SIR Model with a Constant Force of Infection
$\lambda$: force of infection

```r
# LOAD THE PACKAGES:

library(deSolve)
library(reshape2)
library(ggplot2)

# MODEL INPUTS:

initial_state_values <- c(S = 10^6-1, I = 1, R = 0)

parameters <- c(lambda=0.2,
                gamma = 0.1)          


# TIMESTEPS:

times <- seq(from = 0, to = 60, by = 1) 

# SIR MODEL FUNCTION 
# We are renaming this to sir_model. 
# Remember to include the input arguments, 
# differential equations and output objects here.

sir_model <- function(time, state, parameters) {  

    with(as.list(c(state, parameters)), {  
        
    # The differential equations
      dS <- - lambda * S
      dI <- -gamma * I + lambda * S
      dR <- gamma * I            
      
    return(list(c(dS, dI, dR))) 
    })
  
}

# MODEL OUTPUT (solving the differential equations):

output <- as.data.frame(ode(y = initial_state_values, 
                            times = times, 
                            func = sir_model,
                            parms = parameters))

# Plot:

output_long <- melt(as.data.frame(output), id = "time")     

ggplot(data = output_long,   # specify object containing data to plot
       aes(x = time, 
           y = value, 
           colour = variable, 
           group = variable)) +       # assign columns to axes and groups
  geom_line() +                       # represent data as lines
  xlab("Time (days)")+                # add label for x axis
  ylab("Number of people") +          # add label for y axis
  labs(colour = "Compartment")        # add legend title
```

#### SIR Model with a Dynamic Force of Infection
  <img src="/files/2023-04-11-IDM/Screenshot%202023-04-14%20at%2011.55.02.webp" width="500"/>

$\lambda = \beta\frac{I}{N}$
$\beta$ is the infection rate, which may be represented as $p \times c$, where $p$ is the chance of getting infection per contact, and $c$ is the number of contacts made per day.

There is a [good post](https://parasiteecology.wordpress.com/2013/10/17/density-dependent-vs-frequency-dependent-disease-transmission/) on difference between Density-dependent and Frequency-dependent Disease Transmission ($\beta\frac{I}{N}$ and $\beta{I}$). 


  <img src="/files/2023-04-11-IDM/Screenshot%202023-04-15%20at%203.49.21%20PM.webp" width="500"/>

```r
# LOAD THE PACKAGES:

library(deSolve)
library(reshape2)
library(ggplot2)

# MODEL INPUTS:

initial_state_values <- c(S = 10^6-1, I = 1, R = 0)

parameters <- c(beta=1,
                gamma = 0.1)          


# TIMESTEPS:

times <- seq(from = 0, to = 60, by = 1) 

# SIR MODEL FUNCTION 
# We are renaming this to sir_model. 
# Remember to include the input arguments, 
# differential equations and output objects here.

sir_model <- function(time, state, parameters) {  

    with(as.list(c(state, parameters)), {
      N <- S+I+R
      lambda <- beta * (I/(N))
    # The differential equations
      dS <- -lambda * S
      dI <- -gamma * I + lambda * S
      dR <- gamma * I            
      
    return(list(c(dS, dI, dR))) 
    })
  
}

# MODEL OUTPUT (solving the differential equations):

output <- as.data.frame(ode(y = initial_state_values, 
                            times = times, 
                            func = sir_model,
                            parms = parameters))

# Plot:

output_long <- melt(as.data.frame(output), id = "time")     

ggplot(data = output_long,   # specify object containing data to plot
       aes(x = time, 
           y = value, 
           colour = variable, 
           group = variable)) +       # assign columns to axes and groups
  geom_line() +                       # represent data as lines
  xlab("Time (days)")+                # add label for x axis
  ylab("Number of people") +          # add label for y axis
  labs(colour = "Compartment")        # add legend title
```

#### $R_0$ and $R_{eff}$
$R_0=\frac{\beta}{\gamma}$
$R_{eff} = R_0\frac{S}{N}$

<img src="/files/2023-04-11-IDM/Screenshot%202023-04-15%20at%204.32.27%20PM.webp" width="500"/>
<img src="/files/2023-04-11-IDM/Screenshot%202023-04-15%20at%204.32.34%20PM.webp" width="500"/>
<img src="/files/2023-04-11-IDM/Screenshot%202023-04-15%20at%204.31.57%20PM.webp" width="500"/>
<img src="/files/2023-04-11-IDM/Screenshot%202023-04-15%20at%204.32.15%20PM.webp" width="500"/>

### Modifiers of Population Susceptibility

#### Modeling population turnover

<img src="/files/2023-04-11-IDM/Screenshot%202023-04-15%20at%204.34.49%20PM.webp" width="500"/>

$$
\lambda=\beta{\frac{I}{N}} \\
\frac{dS}{dt}=b(S+I+R)-\mu{S}-\lambda{S}\\
\frac{dI}{dt}=\lambda{S}-\mu{I}-\gamma{I}\\
\frac{dR}{dt}=\gamma{I}-\mu{R}
$$

#### A simple model for vaccination
In this simple model, $p$ of the population is immunized.

<img src="/files/2023-04-11-IDM/Screenshot%202023-04-16%20at%203.15.12%20PM.webp" width="500"/>

The critical vaccination threshold $p_c$ would be:

<img src="/files/2023-04-11-IDM/Screenshot%202023-04-16%20at%204.29.42%20PM.webp" width="500"/>

#### Modelling wanning immunity

<img src="/files/2023-04-11-IDM/Screenshot%202023-04-16%20at%204.32.21%20PM.webp" width="500"/>

## Interventions and Calibration
### Treatment and Vaccination
#### Modelling treatment

<img src="/files/2023-04-11-IDM/Screenshot%202023-04-17%20at%2016.07.59.webp" width="500"/>


## Building on the SIR Model



